"use strict";(self.webpackChunktechnical_tutorial=self.webpackChunktechnical_tutorial||[]).push([[5340],{3905:function(e,t,n){n.d(t,{Zo:function(){return m},kt:function(){return d}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},m=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=p(n),d=i,k=u["".concat(s,".").concat(d)]||u[d]||c[d]||r;return n?a.createElement(k,o(o({ref:t},m),{},{components:n})):a.createElement(k,o({ref:t},m))}));function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var p=2;p<r;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},1414:function(e,t,n){n.r(t),n.d(t,{assets:function(){return m},contentTitle:function(){return s},default:function(){return d},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return c}});var a=n(7462),i=n(3366),r=(n(7294),n(3905)),o=["components"],l={},s="Setup ESLint, Prettier, commitlint, lint-staged and Husky v7 pre-commit and commit-msg git hooks for a ReactJS Project with VSCode Editor from scratch",p={unversionedId:"reactjs/eslint-prettier-reactjs",id:"reactjs/eslint-prettier-reactjs",title:"Setup ESLint, Prettier, commitlint, lint-staged and Husky v7 pre-commit and commit-msg git hooks for a ReactJS Project with VSCode Editor from scratch",description:"_Goal: In this tutorial, we will check code quality (ESLint) and code format (Prettier) for the changes of staged files (lint-staged) before we push a commit with conventional commit format (commitlint)._",source:"@site/docs/reactjs/eslint-prettier-reactjs.md",sourceDirName:"reactjs",slug:"/reactjs/eslint-prettier-reactjs",permalink:"/TechnicalTutorial/docs/reactjs/eslint-prettier-reactjs",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/reactjs/eslint-prettier-reactjs.md",tags:[],version:"current",frontMatter:{},sidebar:"reactjsSideBar"},m={},c=[{value:"<strong><em>Goal: In this tutorial, we will check code quality (<code>ESLint</code>) and code format (<code>Prettier</code>) for the changes of staged files (<code>lint-staged</code>) before we push a commit with conventional commit format (<code>commitlint</code>).</em></strong>",id:"goal-in-this-tutorial-we-will-check-code-quality-eslint-and-code-format-prettier-for-the-changes-of-staged-files-lint-staged-before-we-push-a-commit-with-conventional-commit-format-commitlint",level:3},{value:"ESLint",id:"eslint",level:2},{value:"Setup ESLint",id:"setup-eslint",level:3},{value:"Config ESLint with Airbnb Package",id:"config-eslint-with-airbnb-package",level:3},{value:"Normal Problems",id:"normal-problems",level:3},{value:"ESLint ignore file",id:"eslint-ignore-file",level:3},{value:"Run ESLint",id:"run-eslint",level:3},{value:"Check specific file",id:"check-specific-file",level:4},{value:"Fix errors automatically",id:"fix-errors-automatically",level:4},{value:"Run ESLint with ignoring warnings",id:"run-eslint-with-ignoring-warnings",level:4},{value:"Prettier",id:"prettier",level:2},{value:"eslint-plugin-prettier",id:"eslint-plugin-prettier",level:4},{value:"eslint-config-prettier",id:"eslint-config-prettier",level:4},{value:"VSCode Prettier Plugin",id:"vscode-prettier-plugin",level:3},{value:"Prettier Installation",id:"prettier-installation",level:3},{value:"Config Prettier",id:"config-prettier",level:3},{value:"Add Prettier ignore file",id:"add-prettier-ignore-file",level:3},{value:"Add Prettier as npm command",id:"add-prettier-as-npm-command",level:3},{value:"commitlint",id:"commitlint",level:2},{value:"Install commitlint",id:"install-commitlint",level:3},{value:"Create <code>commitlint.config.js</code> file",id:"create-commitlintconfigjs-file",level:3},{value:"Test the configuration",id:"test-the-configuration",level:3},{value:"lint-staged",id:"lint-staged",level:2},{value:"Install lint-staged",id:"install-lint-staged",level:3},{value:"Config lint-staged",id:"config-lint-staged",level:3},{value:"Husky",id:"husky",level:2},{value:"Install Husky",id:"install-husky",level:3},{value:"Enable Git hooks",id:"enable-git-hooks",level:3},{value:"Support commitlint with commit-msg git hook",id:"support-commitlint-with-commit-msg-git-hook",level:3},{value:"Support lint-staged with pre-commit git hook",id:"support-lint-staged-with-pre-commit-git-hook",level:3},{value:"Conclusion",id:"conclusion",level:2}],u={toc:c};function d(e){var t=e.components,n=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"setup-eslint-prettier-commitlint-lint-staged-and-husky-v7-pre-commit-and-commit-msg-git-hooks-for-a-reactjs-project-with-vscode-editor-from-scratch"},"Setup ESLint, Prettier, commitlint, lint-staged and Husky v7 pre-commit and commit-msg git hooks for a ReactJS Project with VSCode Editor from scratch"),(0,r.kt)("h3",{id:"goal-in-this-tutorial-we-will-check-code-quality-eslint-and-code-format-prettier-for-the-changes-of-staged-files-lint-staged-before-we-push-a-commit-with-conventional-commit-format-commitlint"},(0,r.kt)("strong",{parentName:"h3"},(0,r.kt)("em",{parentName:"strong"},"Goal: In this tutorial, we will check code quality (",(0,r.kt)("inlineCode",{parentName:"em"},"ESLint"),") and code format (",(0,r.kt)("inlineCode",{parentName:"em"},"Prettier"),") for the changes of staged files (",(0,r.kt)("inlineCode",{parentName:"em"},"lint-staged"),") before we push a commit with conventional commit format (",(0,r.kt)("inlineCode",{parentName:"em"},"commitlint"),")."))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"ESLint -")," ",(0,r.kt)("a",{parentName:"p",href:"https://eslint.org/docs/user-guide/getting-started"},"ESLint")," is a tool for identifying and reporting on patterns found in ECMAScript/Javascript code, with the goal of making code more consistent and avoiding bugs."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Prettier -")," ",(0,r.kt)("a",{parentName:"p",href:"https://prettier.io/docs/en/index.html"},"Prettier")," is an opinionated code formatter that ensures that all outputted code conforms to a consistent style."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"commitlint -")," ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/conventional-changelog/commitlint#what-is-commitlint"},"commitlint")," is a tool to check if your commit messages meet the ",(0,r.kt)("a",{parentName:"p",href:"https://www.conventionalcommits.org/en/v1.0.0/"},"conventional commit format")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"lint-staged -")," ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/okonet/lint-staged"},"lint-staged")," is a tool that runs linters to make sure your staged file get formatted before commintting to your code base."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Husky -")," ",(0,r.kt)("a",{parentName:"p",href:"https://typicode.github.io/husky/#/"},"Husky")," is a tool that can help you easily to trigger the git hooks and run your scripts at each git hook stage."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks"},"Git Hooks")," that we will use in this tutorial"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"commit-msg")," is a git hook that validates your project state or commit message before allowing a commit to go through.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"pre-commit")," is a git hook that is useful for identifying issues before code submission. It even run before you type a commit message."))),(0,r.kt)("h2",{id:"eslint"},"ESLint"),(0,r.kt)("p",null,"ESLint is a javascript tool that can check your code for potential errors and bad code practices. It helps you enforce a code statndard and style guide in your codebase."),(0,r.kt)("p",null,"If you create your ReactJS app with ",(0,r.kt)("a",{parentName:"p",href:"https://reactjs.org/docs/create-a-new-react-app.html"},"Create React App"),", the basic ESLint setup has been included in your project."),(0,r.kt)("p",null,"Nowadays the most popular style guides based on ESLint is ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/airbnb/javascript"},"Airbnb Javascript Style Guide"),". We will use Airbnb rules in this tutorial."),(0,r.kt)("h3",{id:"setup-eslint"},"Setup ESLint"),(0,r.kt)("p",null,"Run the below command to install the ESLint to the project."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"npm:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm install eslint --save-dev\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"yarn:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add eslint --dev\n")),(0,r.kt)("p",null,"If you want to install ESLint globally cross all of your projects, you can install ESLint with"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"npm:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm install -g eslint\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"yarn:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add -g eslint\n")),(0,r.kt)("p",null,"I personally prefer to use local eslint, So I will use local eslint for the rest of the tutorial."),(0,r.kt)("h3",{id:"config-eslint-with-airbnb-package"},"Config ESLint with Airbnb Package"),(0,r.kt)("p",null,"Creating a ESLint configuration file with running:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npx eslint --init\n")),(0,r.kt)("p",null,"You need to answer serveral questions about configuration files."),(0,r.kt)("p",null,"Here is my choices:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"How would you like to use ESLint?"))),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"\u2023 To check syntax, find problems, and enforce code style")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"What type of modules does your project use?"))),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"\u2023 JavaScript modules (import/export)")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Which framework does your project use?"))),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"\u2023 React")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Does your project use TypeScript?"))),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"\u2023 No"))," (Depends on which language you use in your project)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Where does your code run?"))),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Browser"))," (Choose Node if you are programing backend)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"How would you like to define a style for your project?"))),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"\u25b8 Use a popular style guide")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Which style guide do you want to follow?"))),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Airbnb: ",(0,r.kt)("a",{parentName:"em",href:"https://github.com/airbnb/javascript"},"https://github.com/airbnb/javascript"))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"What format do you want your config file to be in?"))),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"\u25b8 JSON"))))),(0,r.kt)("p",null,"Then the programe will check dependencies and ask if you want to install the dependencies."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"The config that you've selected requires the following dependencies:\n\neslint-plugin-react@^7.21.5 eslint-config-airbnb@latest eslint@^5.16.0 || ^6.8.0 || ^7.2.0 eslint-plugin-import@^2.22.1 eslint-plugin-jsx-a11y@^6.4.1 eslint-plugin-react-hooks@^4 || ^3 || ^2.3.0 || ^1.7.0\n")),(0,r.kt)("p",null,"Choose ",(0,r.kt)("inlineCode",{parentName:"p"},"yes")," to install all the dependencies"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Would you like to install them now with npm?"))),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"\u2023 Yes"))))),(0,r.kt)("p",null,"Now after you install the ESLint with Airbnb package,"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Open your VSCode,"),(0,r.kt)("li",{parentName:"ol"},"Go to ",(0,r.kt)("inlineCode",{parentName:"li"},"Extensions")," ",(0,r.kt)("img",{src:"https://user-images.githubusercontent.com/10986601/124714671-9ec5f900-df34-11eb-8753-06bcab58f58d.png",width:"25",height:"25"}),","),(0,r.kt)("li",{parentName:"ol"},"Search ",(0,r.kt)("inlineCode",{parentName:"li"},"ESlint"),","),(0,r.kt)("li",{parentName:"ol"},"Choose the one made by ",(0,r.kt)("inlineCode",{parentName:"li"},"Microsoft"),","),(0,r.kt)("li",{parentName:"ol"},"Reopen your project with VSCode.")),(0,r.kt)("p",null,"Open the VSCode terminal and click the ",(0,r.kt)("inlineCode",{parentName:"p"},"PROBLEMS")," tab, you will see ESLint already checked your file's potential syntax problems based on the Airbnb rules that you installed with above steps."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/10986601/124716273-7939ef00-df36-11eb-878f-00b72ee72999.png",alt:"image"})),(0,r.kt)("p",null,"And there will be an ",(0,r.kt)("inlineCode",{parentName:"p"},".eslintrc.json")," file created at your project root folder."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "env": {\n    "browser": true,\n    "es2021": true\n  },\n  "extends": ["airbnb"],\n  "parserOptions": {\n    "ecmaFeatures": {\n      "jsx": true\n    },\n    "ecmaVersion": 12,\n    "sourceType": "module"\n  },\n  "plugins": [],\n  "rules": {}\n}\n')),(0,r.kt)("p",null,"You can put your rules under the ",(0,r.kt)("inlineCode",{parentName:"p"},"rules")," block."),(0,r.kt)("h3",{id:"normal-problems"},"Normal Problems"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"'React' must be in scope when using JSX"))),(0,r.kt)("p",null,"For React 17.x.x, based on ",(0,r.kt)("a",{parentName:"p",href:"https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html#eslint"},"React Docs"),"."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"If you are using ",(0,r.kt)("inlineCode",{parentName:"p"},"eslint-plugin-react"),", the ",(0,r.kt)("inlineCode",{parentName:"p"},"react/jsx-uses-react"),"and ",(0,r.kt)("inlineCode",{parentName:"p"},"react/react-in-jsx-scope rules")," are no longer necessary and can be turned off or removed.")),(0,r.kt)("p",null,"So we can turn these two rules off at the ",(0,r.kt)("inlineCode",{parentName:"p"},"rules")," block (if exists):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  // ...\n  "rules": {\n    // ...\n    "react/jsx-uses-react": "off",\n    "react/react-in-jsx-scope": "off"\n  }\n}\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"JSX not allowed in files with extension '.js'"))),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/airbnb/javascript/tree/master/react#naming"},"Airbnb React/JSX Style Guide")," suggests to use ",(0,r.kt)("inlineCode",{parentName:"p"},".jsx")," extension for React components (eslint: react/jsx-filename-extension), you can rename your ",(0,r.kt)("inlineCode",{parentName:"p"},".js")," to ",(0,r.kt)("inlineCode",{parentName:"p"},".jsx"),". If you don't want to strictly use ",(0,r.kt)("inlineCode",{parentName:"p"},".jsx")," as extension of your files, you can turn the rules ",(0,r.kt)("inlineCode",{parentName:"p"},"off")," or add the following rules in the ",(0,r.kt)("inlineCode",{parentName:"p"},".eslintrc.json")," file"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  // ...\n  "rules": {\n    // ...\n    "react/jsx-filename-extension": [1, { "extensions": [".js", ".jsx"] }]\n  }\n}\n')),(0,r.kt)("p",null,"For these who use Typescript, your can add rules like"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  // ...\n  "rules": {\n    // ...\n    "react/jsx-filename-extension": [\n      "error",\n      { "extensions": [".js", ".jsx", ".ts", ".tsx"] }\n    ]\n  }\n}\n')),(0,r.kt)("p",null,"For solving typescript common problems, please check ",(0,r.kt)("a",{parentName:"p",href:"https://andrebnassis.medium.com/setting-eslint-on-a-react-typescript-project-2021-1190a43ffba"},"this tutorial"),"."),(0,r.kt)("h3",{id:"eslint-ignore-file"},"ESLint ignore file"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},".eslintignore")," is the file where we can add files and folders that will not be applied the ESLint rules."),(0,r.kt)("p",null,"For example, we can add ",(0,r.kt)("inlineCode",{parentName:"p"},"node_modules")," into this file."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"node_modules/**\n")),(0,r.kt)("h3",{id:"run-eslint"},"Run ESLint"),(0,r.kt)("h4",{id:"check-specific-file"},"Check specific file"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npx eslint yourTargetFile.js\n")),(0,r.kt)("h4",{id:"fix-errors-automatically"},"Fix errors automatically"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npx eslint yourTargetFile.js --fix\n")),(0,r.kt)("h4",{id:"run-eslint-with-ignoring-warnings"},"Run ESLint with ignoring warnings"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npx eslint yourTargetFile.js --quiet\n")),(0,r.kt)("h2",{id:"prettier"},"Prettier"),(0,r.kt)("p",null,"We use ",(0,r.kt)("inlineCode",{parentName:"p"},"Prettier")," to formate our code, cooperating with ESLinter. ",(0,r.kt)("a",{parentName:"p",href:"https://prettier.io/docs/en/comparison.html"},"This article")," is the comparition between ",(0,r.kt)("inlineCode",{parentName:"p"},"Prettier")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Linters"),". Based on ",(0,r.kt)("a",{parentName:"p",href:"https://prettier.io/docs/en/integrating-with-linters.html"},"Integrating with Linters"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Prettier")," is for ",(0,r.kt)("inlineCode",{parentName:"p"},"code formatting concerns"),", Linters are for ",(0,r.kt)("inlineCode",{parentName:"p"},"code-quality concerns"),"."),(0,r.kt)("h4",{id:"eslint-plugin-prettier"},"eslint-plugin-prettier"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"eslint-plugin-prettier")," allows you run the Prettier as ESLint rule and report issues that differ from Prettier's expected output as ESLint errors."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://stackoverflow.com/questions/44690308/whats-the-difference-between-prettier-eslint-eslint-plugin-prettier-and-eslint"},"This")," is the comparison among ",(0,r.kt)("inlineCode",{parentName:"p"},"eslint-config-pretter"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"eslint-plugin-prettier")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"prettier-eslint")),(0,r.kt)("h4",{id:"eslint-config-prettier"},"eslint-config-prettier"),(0,r.kt)("p",null,"Since ESLint also contains stylistic rules which might conflict with Prettier, we can turn off these rules that conflict or are unnecessary with Prettier by using ",(0,r.kt)("inlineCode",{parentName:"p"},"eslint-config-pretter")),(0,r.kt)("h3",{id:"vscode-prettier-plugin"},"VSCode Prettier Plugin"),(0,r.kt)("p",null,"Open your VSCode Extensions and search ",(0,r.kt)("inlineCode",{parentName:"p"},"Prettier"),", install the ",(0,r.kt)("inlineCode",{parentName:"p"},"Prettier - Code formatter")," made by ",(0,r.kt)("inlineCode",{parentName:"p"},"Prettier"),"."),(0,r.kt)("h3",{id:"prettier-installation"},"Prettier Installation"),(0,r.kt)("p",null,"In your project folder, install the dependencies about Prettier."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm install prettier eslint-config-prettier eslint-plugin-prettier --save-dev\n")),(0,r.kt)("h3",{id:"config-prettier"},"Config Prettier"),(0,r.kt)("p",null,"Add ",(0,r.kt)("inlineCode",{parentName:"p"},"eslint-plugin-prettier")," to ",(0,r.kt)("inlineCode",{parentName:"p"},'"prettier"')," and ",(0,r.kt)("inlineCode",{parentName:"p"},'"rules"')," of your ",(0,r.kt)("inlineCode",{parentName:"p"},".eslintrc.json")," file that you created from last section."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "plugins": ["prettier"],\n  "rules": {\n    "prettier/prettier": "error"\n  }\n}\n')),(0,r.kt)("p",null,"This plugin ships with a ",(0,r.kt)("inlineCode",{parentName:"p"},"plugin:prettier/recommended")," config that sets up both the ",(0,r.kt)("inlineCode",{parentName:"p"},"plugin")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"eslint-config-prettier")," in one go."),(0,r.kt)("p",null,"Add ",(0,r.kt)("inlineCode",{parentName:"p"},"eslint-config-prettier")," to ",(0,r.kt)("inlineCode",{parentName:"p"},'"extends"')," of your ",(0,r.kt)("inlineCode",{parentName:"p"},".eslintrc.json")," file that you created from last section."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  // ...\n  "extends": ["airbnb", "plugin:prettier/recommended"]\n}\n')),(0,r.kt)("p",null,"Since airbnb rules could have conflict rules with Prettier, for example, Airbnb javascript style guide asks"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Always use double quotes (\") for JSX attributes, but single quotes (') for all other JS.")),(0,r.kt)("p",null,"However, Prettier uses ",(0,r.kt)("a",{parentName:"p",href:"https://prettier.io/docs/en/options.html#quotes"},"double quotes")," by default even though it doesn't suggest."),(0,r.kt)("p",null,"For solving this kind of conflicts, We need to create a ",(0,r.kt)("inlineCode",{parentName:"p"},".prettierrc")," file under your project folder with code:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "semi": true,\n  "trailingComma": "es5",\n  "printWidth": 120,\n  "singleQuote": true,\n  "arrowParens": "always",\n  "proseWrap": "preserve"\n}\n')),(0,r.kt)("h3",{id:"add-prettier-ignore-file"},"Add Prettier ignore file"),(0,r.kt)("p",null,"We can create ",(0,r.kt)("inlineCode",{parentName:"p"},".prettierignore")," file under the poject root folder to contain the files that we want to ignore prettier check."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"node_modules/**\n")),(0,r.kt)("h3",{id:"add-prettier-as-npm-command"},"Add Prettier as npm command"),(0,r.kt)("p",null,"We can also format all of our code by using prettier with a command line."),(0,r.kt)("p",null,"Open your ",(0,r.kt)("inlineCode",{parentName:"p"},"package.json")," and add the below code block to your ",(0,r.kt)("inlineCode",{parentName:"p"},"scripts"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  // ...\n  "scripts": {\n    // ...\n    "format": "prettier --write \\"**/*.{js,jsx,json,md}\\""\n  }\n}\n')),(0,r.kt)("h2",{id:"commitlint"},"commitlint"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"commintlint")," helps your team adhering to a commit convention. You can check ",(0,r.kt)("a",{parentName:"p",href:"https://www.conventionalcommits.org/en/v1.0.0/"},"Conventional Commits")," for more details."),(0,r.kt)("h3",{id:"install-commitlint"},"Install commitlint"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm install @commitlint/cli @commitlint/config-conventional --save-dev\n")),(0,r.kt)("h3",{id:"create-commitlintconfigjs-file"},"Create ",(0,r.kt)("inlineCode",{parentName:"h3"},"commitlint.config.js")," file"),(0,r.kt)("p",null,"Create the ",(0,r.kt)("inlineCode",{parentName:"p"},"commitlint.config.js")," file at your project root folder, add the below configuration to the file."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = { extends: ['@commitlint/config-conventional'] };\n")),(0,r.kt)("h3",{id:"test-the-configuration"},"Test the configuration"),(0,r.kt)("p",null,"We install the commitlint locally, so run"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"echo 'foo: bar' | node_modules/.bin/commitlint\n")),(0,r.kt)("p",null,"We will get"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"\u29d7   input: foo: bar\n\u2716   type must be one of [build, chore, ci, docs, feat, fix, perf, refactor, revert, style, test] [type-enum]\n\n\u2716   found 1 problems, 0 warnings\n\u24d8   Get help: https://github.com/conventional-changelog/commitlint/#what-is-commitlint\n")),(0,r.kt)("h2",{id:"lint-staged"},"lint-staged"),(0,r.kt)("p",null,"Since git hook (which we will install and use soon) will check all the files of the projects, this kind of checking will be time-consuming for a large project,. For solving this problem, we can install ",(0,r.kt)("inlineCode",{parentName:"p"},"lint-staged")," package to only check the files that are only changed and staged."),(0,r.kt)("h3",{id:"install-lint-staged"},"Install lint-staged"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm install lint-staged --save-dev\n")),(0,r.kt)("h3",{id:"config-lint-staged"},"Config lint-staged"),(0,r.kt)("p",null,"Based on ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/okonet/lint-staged"},"lint-staged document"),", we can config lint-staged in ",(0,r.kt)("inlineCode",{parentName:"p"},".lintstagedrc")," file with ",(0,r.kt)("inlineCode",{parentName:"p"},"JSON")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"YAML")," format."),(0,r.kt)("p",null,"Let's create a file called ",(0,r.kt)("inlineCode",{parentName:"p"},".lintstagedrc.json")," at the root directory and add the below lint-staged command in it. You can check ",(0,r.kt)("inlineCode",{parentName:"p"},"lint-staged document")," to figure out what command that lint-staged supports."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "src/**/*.+(js|json|ts|tsx)": ["eslint"],\n  "src/**/*.{js,jsx,ts,tsx,json,css,scss,md}": ["prettier --write"]\n}\n')),(0,r.kt)("h2",{id:"husky"},"Husky"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://typicode.github.io/husky/#/?id=features"},"Husky")," is a tool to easily trigger the git hooks and run our scripts at each stage of a commit."),(0,r.kt)("h3",{id:"install-husky"},"Install Husky"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"When I write this article, the latest version of Husky is ",(0,r.kt)("inlineCode",{parentName:"em"},"7"))),(0,r.kt)("p",null,"Run the below command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm install husky --save-dev\n")),(0,r.kt)("p",null,"In the ",(0,r.kt)("inlineCode",{parentName:"p"},"pacakge.json")," file, You should have:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'// package.json\n{\n  "scripts": {\n    "prepare": "husky install"\n  }\n}\n')),(0,r.kt)("h3",{id:"enable-git-hooks"},"Enable Git hooks"),(0,r.kt)("p",null,"Run the below code to enable git hooks"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npx husky install\n")),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Optional: If you want to enable git hooks automatically after install, you can run:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'npm set-script prepare "husky install"\n')),(0,r.kt)("p",null,"There will be a ",(0,r.kt)("inlineCode",{parentName:"p"},".husky/")," folder created in your project, where you can put your git hooks scripts."),(0,r.kt)("p",null,"For example, run"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'npx husky add .husky/pre-commit "npm test"\n')),(0,r.kt)("p",null,"This command will create a ",(0,r.kt)("inlineCode",{parentName:"p"},"pre-commit")," file in the ",(0,r.kt)("inlineCode",{parentName:"p"},".husky")," folder with content ",(0,r.kt)("inlineCode",{parentName:"p"},"npm test"),". Each time when you push a new commit, it will the test at first, if the test failed, the whole commit will be automatically aborted."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"NOTE:"))),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"By design, ",(0,r.kt)("inlineCode",{parentName:"p"},"husky install")," must be run in the same directory as ",(0,r.kt)("inlineCode",{parentName:"p"},".git"),", but you can change directory during prepare script and pass a subdirectory:"),(0,r.kt)("pre",{parentName:"blockquote"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'// package.json\n{\n  "scripts": {\n    "prepare": "cd .. && husky install front/.husky"\n  }\n}\n')),(0,r.kt)("p",{parentName:"blockquote"},"In your hooks, you'll also need to change directory:"),(0,r.kt)("pre",{parentName:"blockquote"},(0,r.kt)("code",{parentName:"pre"},"# .husky/pre-commit\n# ...\ncd front\nnpm test\n"))),(0,r.kt)("h3",{id:"support-commitlint-with-commit-msg-git-hook"},"Support commitlint with commit-msg git hook"),(0,r.kt)("p",null,"Add ",(0,r.kt)("inlineCode",{parentName:"p"},"commit-msg")," file at your root directory with the below command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npx husky add .husky/commit-msg 'npx --no-install commitlint --edit \"$1\"'\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"commit-msg")," is a git hook that can validate your project state or commit message before allowing a commit to go through."),(0,r.kt)("p",null,"Now if you commit your code again, you will find you can only commit your changes with following the conventional commit message format."),(0,r.kt)("h3",{id:"support-lint-staged-with-pre-commit-git-hook"},"Support lint-staged with pre-commit git hook"),(0,r.kt)("p",null,"Add ",(0,r.kt)("inlineCode",{parentName:"p"},"pre-commit")," file at your root directory with the below command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npx husky add .husky/pre-commit 'npm run lint-staged'\n")),(0,r.kt)("p",null,"Open your ",(0,r.kt)("inlineCode",{parentName:"p"},"package.json")," file, add the below code to the ",(0,r.kt)("inlineCode",{parentName:"p"},"scripts"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  // ...\n  "scripts:" {\n    // ...\n    "lint-staged": "lint-staged",\n  }\n}\n')),(0,r.kt)("p",null,"Now go to ",(0,r.kt)("inlineCode",{parentName:"p"},".husky/pre-commit")," file, add the below code to the file"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/sh\n. "$(dirname "$0")/_/husky.sh"\n\nnpm run lint-staged\n')),(0,r.kt)("h2",{id:"conclusion"},"Conclusion"),(0,r.kt)("p",null,"Now if you commit the changes of your project again,"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"ESLint")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Prettier"),"\nwill check your code quality and format of your changed files at ",(0,r.kt)("inlineCode",{parentName:"p"},"pre-commit")," hook stage.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"The tool ",(0,r.kt)("inlineCode",{parentName:"p"},"commitlint")," will check if your commit message follow the ",(0,r.kt)("inlineCode",{parentName:"p"},"Conventional Commit Format")," at ",(0,r.kt)("inlineCode",{parentName:"p"},"commit-msg")," stage."))),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"NOTE: pre-commit will be trigger at first and then commitlint get triggered")),(0,r.kt)("p",null,"Either of above steps failed, the whole commit will be aborted, which means you won't commit your dirty code to the repository any more."),(0,r.kt)("p",null,"Overall, in this article, we use ",(0,r.kt)("inlineCode",{parentName:"p"},"Husky")," to control two git states before pushing a commit to remote repository."),(0,r.kt)("p",null,"One is using ",(0,r.kt)("inlineCode",{parentName:"p"},"lint-staged")," to check staged specific files (configured in ",(0,r.kt)("inlineCode",{parentName:"p"},".lintstagedrc"),") with ",(0,r.kt)("inlineCode",{parentName:"p"},"eslint")," (to check code quality) and ",(0,r.kt)("inlineCode",{parentName:"p"},"prettier")," (to check code style) at ",(0,r.kt)("inlineCode",{parentName:"p"},"pre-commit")," stage."),(0,r.kt)("p",null,"The other one is using ",(0,r.kt)("inlineCode",{parentName:"p"},"commitlint")," to force to format the commit message at ",(0,r.kt)("inlineCode",{parentName:"p"},"commit-msg")," stage."))}d.isMDXComponent=!0}}]);